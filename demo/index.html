<!DOCTYPE html>
<html>
<head>
<title>AgentReputation DAO</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  font-family: 'Courier New', monospace;
  background: #000;
  color: #58C88D;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  display: flex;
  font-size: 13px;
}

/* LEFT PANEL - Crisis & Solution */
.left-panel {
  width: 32%;
  height: 100vh;
  background: #0f0f0f;
  border-right: 3px solid #58C88D;
  padding: 15px;
  overflow: hidden;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  display: flex;
  flex-direction: column;
}

.crisis-box {
  background: rgba(255, 50, 80, 0.12);
  border-left: 4px solid #ff3366;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 4px;
}

.crisis-box h2 {
  color: #ff3366;
  margin-bottom: 8px;
  font-size: 14px;
  font-weight: bold;
}

.solution-box {
  background: rgba(0, 200, 255, 0.12);
  border-left: 4px solid #00ccff;
  padding: 12px;
  border-radius: 4px;
}

.solution-box h2 {
  color: #00ccff;
  margin-bottom: 8px;
  font-size: 14px;
  font-weight: bold;
}

/* CENTER PANEL - Live Data */
.center-panel {
  width: 38%;
  height: 100vh;
  background: #121212;
  padding: 10px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.terminal {
  background: #000;
  border: 1px solid #58C88D;
  padding: 15px;
  height: calc(100vh - 200px);
  overflow-y: auto;
  font-size: 12px;
  line-height: 1.6;
}

.terminal-header {
  background: #58C88D;
  color: #000;
  padding: 5px 10px;
  font-weight: bold;
  margin: -15px -15px 10px -15px;
}

.agent-card {
  background: rgba(0, 255, 65, 0.05);
  border-left: 3px solid #58C88D;
  padding: 10px;
  margin: 10px 0;
  font-size: 13px;
}

.agent-card.suspicious {
  border-left-color: #ff0040;
  background: rgba(255, 0, 64, 0.05);
}

/* RIGHT PANEL - Calculator */
.right-panel {
  width: 30%;
  height: 100vh;
  background: #0f0f0f;
  border-left: 2px solid #58C88D;
  padding: 10px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.calculator-box {
  background: rgba(0, 255, 65, 0.08);
  border: 1px solid #58C88D;
  padding: 15px;
  margin-bottom: 20px;
}

input, select {
  width: 100%;
  padding: 8px;
  margin: 5px 0;
  background: #000;
  border: 1px solid #58C88D;
  color: #58C88D;
  font-family: 'Courier New', monospace;
}

.stake-result {
  font-size: 24px;
  text-align: center;
  color: #58C88D;
  margin: 10px 0;
  font-weight: bold;
}

.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
  margin: 20px 0;
}

.stat-box {
  background: rgba(0, 40, 20, 0.8);
  border: 1px solid #58C88D;
  padding: 8px;
  text-align: center;
}

.stat-number {
  font-size: 20px;
  font-weight: bold;
  color: #58C88D;
}

.blink {
  animation: blink 1s infinite;
}

@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

h1 {
  color: #58C88D;
  font-size: 28px;
  letter-spacing: 2px;
  text-shadow: 0 0 10px rgba(0,255,65,0.5);
}

.log-entry { margin: 3px 0; }
.log-reg { color: #58C88D; }
.log-vouch { color: #00ccff; }
.log-slash { color: #ff0040; }
.log-alert { color: #ffaa00; }
</style>
</head>
<body>

<!-- LEFT PANEL -->
<div class="left-panel">
  <div style="text-align:center; margin-bottom:10px; border:2px solid #58C88D; padding:14px; background:#0a1a0a; flex-shrink:0;">
    <div style="font-size:11px; color:#58C88D; margin-bottom:5px; letter-spacing:3px; font-weight:bold;">COLOSSEUM 2026</div>
    <h1 style="margin:8px 0; font-weight:800; font-size:28px; color:#58C88D;">AGENT REP DAO</h1>
    <div style="font-size:13px; color:#00ccff; font-weight:bold; margin:8px 0;">ECONOMIC-BACKED TRUST</div>
    <div style="font-size:10px; color:#636363; margin-top:5px;">100% AI BUILT</div>
    <div style="background:rgba(255,200,0,0.15); border:1px solid #ffd700; padding:8px; margin-top:10px; border-radius:4px; text-align:center;">
      <span style="font-size:11px; color:#ffd700; font-weight:bold;">üîß DEVNET LIVE</span>
      <span style="font-size:10px; color:#aaa; display:block; margin-top:3px;">Mainnet launches in 7 days</span>
    </div>
  </div>

  <div class="crisis-box" style="padding:14px; margin-bottom:10px;">
    <h2 style="font-size:17px; margin-bottom:10px; color:#ff3366; font-weight:bold;">‚ö†Ô∏è THE CHAOS</h2>
    <p style="font-size:14px; line-height:1.7; color:#fff;">
      <strong style="color:#ff3366; font-size:15px;">1000+ agents daily. 90% fail.</strong><br>
      <span style="color:#ff6666;">Why? No trust layer.</span><br><br>
      <span style="color:#ff8888;">‚ùå Ratings?</span> Faked.<br>
      <span style="color:#ff8888;">‚ùå History?</span> Locked.<br>
      <span style="color:#ff8888;">‚ùå Word of mouth?</span> No memory.<br>
      <strong style="color:#fff; background:rgba(255,51,102,0.3); padding:4px 10px; border-radius:4px; font-size:12px; display:inline-block; margin-top:8px;">Economy at 10% speed</strong>
    </p>
  </div>

  <div class="solution-box" style="padding:14px; margin-bottom:10px;">
    <h2 style="font-size:17px; margin-bottom:10px; color:#00ccff; font-weight:bold;">üí° SOLUTION</h2>
    <p style="font-size:14px; line-height:1.7; color:#fff;">
      <strong style="color:#00ccff; font-size:15px;">Staked Vouching = Instant Trust</strong><br><br>
      <span style="color:#66ddff;">‚úì 0.1 SOL</span> = Verify<br>
      <span style="color:#66ddff;">‚úì 2-5 SOL</span> = High cred<br>
      <span style="color:#66ddff;">‚úì 5 SOL</span> = Elite<br>
      <strong style="color:#00ccff; font-size:15px; display:block; margin:10px 0;">Risk = Trust</strong>
      Bad actors lose money.
    </p>
  </div>

  <div style="background:linear-gradient(135deg, #00ccff 0%, #0066cc 100%); color:#fff; padding:10px; margin-top:8px; border-radius:6px; text-align:center; font-weight:bold; font-size:13px; flex-shrink:0;">
    ‚ö° STAKE = INSTANT TRUST ‚ö° | 0.1-5 SOL
  </div>
</div>

<!-- CENTER PANEL -->
<div class="center-panel">
  <!-- STATS ROW -->
  <div class="stats-grid" style="margin:6px 0; flex-shrink:0;">
    <div class="stat-box" style="padding:8px;">
      <div class="stat-number" style="font-size:22px;">4</div>
      <div style="font-size:11px; color:#636363;">AGENTS</div>
    </div>
    <div class="stat-box" style="padding:8px;">
      <div class="stat-number" style="font-size:22px;">78</div>
      <div style="font-size:11px; color:#636363;">SOL</div>
    </div>
    <div class="stat-box" style="padding:8px;">
      <div class="stat-number" style="font-size:22px;">156</div>
      <div style="font-size:11px; color:#636363;">VOUCHES</div>
    </div>
  </div>

  <!-- AGENT REGISTRY -->
  <h2 style="margin:6px 0 4px; color:#58C88D; font-size:16px; flex-shrink:0; font-weight:bold;">üìä LIVE AGENT REGISTRY</h2>
  <div id="agent-list" style="flex:0 0 auto;"></div>
  
  <!-- VERIFICATION ALGORITHM LEGEND -->
  <div style="background:rgba(0,0,0,0.6); border:1px solid #58C88D; padding:12px; margin:6px 0; border-radius:4px; font-size:13px; flex-shrink:0;">
    <div style="color:#58C88D; font-weight:bold; margin-bottom:6px; font-size:14px;">üìã VERIFICATION ALGORITHM</div>
    <div style="color:#aaa; line-height:1.5;">
      <span style="color:#58C88D;">‚úÖ VERIFIED (700+):</span> High rep + stake + accuracy | 
      <span style="color:#ffaa00;">‚ö†Ô∏è MONITORING (300-699):</span> Building trust | 
      <span style="color:#ff4444;">üö´ SUSPICIOUS (&lt;300):</span> Low metrics<br>
      <span style="color:#888;">Scoring: Rep(0-400) + Stake(0-300) + Accuracy(0-200) + Activity(0-100)</span>
    </div>
  </div>

  <!-- NETWORK MONITOR - Now at bottom -->
  <div class="terminal" style="height:240px; flex-shrink:0; margin-top:5px;">
    <div class="terminal-header" style="font-size:12px; padding:5px 10px;">üñ•Ô∏è NETWORK MONITOR <span class="blink">‚óè</span></div>
    <div id="terminal-content" style="font-size:12px; line-height:1.4;">
      <div style="color:#636363;">$ ./monitor --live</div>
    </div>
  </div>
</div>

<!-- RIGHT PANEL -->
<div class="right-panel">
  <div class="calculator-box" style="padding:10px; margin-bottom:8px; flex-shrink:0;">
    <h3 style="color:#58C88D; margin-bottom:8px; font-size:13px;">üí∞ STAKE CALCULATOR</h3>

    <label style="font-size:9px;">TASK</label>
    <div style="display:flex; flex-wrap:wrap; gap:3px; margin:4px 0;">
      <button onclick="setTask(1)" id="btn-task-1" style="flex:1; padding:5px; font-size:9px; background:rgba(0,255,65,0.1); border:1px solid #58C88D; color:#58C88D; cursor:pointer;">Small</button>
      <button onclick="setTask(3)" id="btn-task-3" style="flex:1; padding:5px; font-size:9px; background:rgba(0,255,65,0.1); border:1px solid #58C88D; color:#58C88D; cursor:pointer;">Medium</button>
      <button onclick="setTask(5)" id="btn-task-5" style="flex:1; padding:5px; font-size:9px; background:rgba(0,255,65,0.1); border:1px solid #58C88D; color:#58C88D; cursor:pointer;">Large</button>
      <button onclick="setTask(10)" id="btn-task-10" style="flex:1; padding:5px; font-size:9px; background:rgba(0,255,65,0.1); border:1px solid #58C88D; color:#58C88D; cursor:pointer;">Critical</button>
    </div>

    <div style="background:rgba(0,0,0,0.5); padding:10px; border-radius:6px; margin:8px 0; border:1px solid #58C88D;">
      <div style="text-align:center; font-size:11px; color:#58C88D; margin-bottom:8px; font-weight:bold;">üí∞ SELECT STAKE AMOUNT</div>

      <!-- Fine tune row -->
      <div style="display:flex; gap:4px; margin-bottom:6px;">
        <button onclick="adjustStake(-0.1)" style="padding:6px 10px; font-size:14px; background:#ff4444; border:none; color:#fff; cursor:pointer; font-weight:bold; border-radius:4px;">-</button>
        <button onclick="setStake(0.1)" id="btn-stake-01" style="flex:1; padding:6px; font-size:10px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px;">0.1</button>
        <button onclick="setStake(0.25)" id="btn-stake-025" style="flex:1; padding:6px; font-size:10px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px;">0.25</button>
        <button onclick="setStake(0.5)" id="btn-stake-05" style="flex:1; padding:6px; font-size:10px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px;">0.5</button>
        <button onclick="adjustStake(0.1)" style="padding:6px 10px; font-size:14px; background:#58C88D; border:none; color:#000; cursor:pointer; font-weight:bold; border-radius:4px;">+</button>
      </div>

      <!-- Main amounts row -->
      <div style="display:flex; gap:4px;">
        <button onclick="setStake(1)" id="btn-stake-1" style="flex:1; padding:8px; font-size:11px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px; font-weight:bold;">1 SOL</button>
        <button onclick="setStake(2.5)" id="btn-stake-25" style="flex:1; padding:8px; font-size:11px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px; font-weight:bold;">2.5</button>
        <button onclick="setStake(3)" id="btn-stake-3" style="flex:1; padding:8px; font-size:11px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px; font-weight:bold;">3</button>
        <button onclick="setStake(5)" id="btn-stake-5" style="flex:1; padding:8px; font-size:11px; background:rgba(255,200,0,0.2); border:2px solid #ffd700; color:#ffd700; cursor:pointer; border-radius:4px; font-weight:bold;">5 MAX</button>
      </div>
    </div>

    <!-- Current stake big display -->
    <div style="text-align:center; margin:10px 0;">
      <div style="font-size:28px; font-weight:bold; color:#58C88D;" id="current-stake-display">0.1</div>
      <div style="font-size:12px; color:#636363;">SOL STAKED</div>
    </div>

    <!-- Trust Score Section -->
    <div style="background:rgba(0,0,0,0.5); padding:10px; border-radius:6px; border:1px solid #58C88D;">
      <div style="text-align:center; font-size:11px; color:#58C88D; margin-bottom:6px; font-weight:bold;">‚≠ê YOUR TRUST LEVEL</div>
      <div style="display:flex; gap:4px; margin-bottom:6px;">
        <button onclick="setReputation(0)" id="btn-rep-new" style="flex:1; padding:6px; font-size:9px; background:#58C88D; border:1px solid #58C88D; color:#000; cursor:pointer; border-radius:4px; font-weight:bold;">NEW (0)</button>
        <button onclick="setReputation(250)" id="btn-rep-established" style="flex:1; padding:6px; font-size:9px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px;">EST (250)</button>
        <button onclick="setReputation(500)" id="btn-rep-trusted" style="flex:1; padding:6px; font-size:9px; background:rgba(88,200,141,0.15); border:1px solid #58C88D; color:#58C88D; cursor:pointer; border-radius:4px;">TRUSTED (500)</button>
      </div>
      <input type="range" id="rep" min="0" max="1000" value="0" oninput="calc()" style="width:100%; margin:4px 0;">
      <div style="text-align:center; font-size:10px; color:#636363; margin-top:4px;">
        <span id="repval">New Agent</span> | <span id="discount-display">0%</span> discount
      </div>
    </div>

    <!-- Calculation Result -->
    <div style="background:linear-gradient(135deg, rgba(88,200,141,0.2) 0%, rgba(88,200,141,0.05) 100%); padding:12px; border-radius:6px; margin-top:10px; border:1px solid #58C88D; text-align:center;">
      <div style="font-size:10px; color:#636363; margin-bottom:4px;">REQUIRED STAKE FOR THIS TASK</div>
      <div style="font-size:32px; font-weight:bold; color:#58C88D; margin:4px 0;" id="stake">0.1</div>
      <div style="font-size:12px; color:#58C88D;">SOL</div>
      <div style="font-size:9px; color:#636363; margin-top:6px;" id="breakdown">Base: 0.1 √ó Task: 1√ó | No discount</div>
    </div>
  </div>

  <div class="calculator-box" style="padding:10px; flex-shrink:0;">
    <h3 style="color:#58C88D; margin-bottom:6px; font-size:12px;">üõ°Ô∏è ANTI-ABUSE</h3>
    <div style="font-size:10px; line-height:1.6;">
      <div style="color:#58C88D;">‚úÖ Pattern Detection</div>
      <div style="color:#58C88D;">‚úÖ Rep Weighting</div>
      <div style="color:#58C88D;">‚úÖ Slashing</div>
    </div>
    <div style="margin-top:8px; padding-top:8px; border-top:1px solid #58C88D; font-size:9px;">
      <span style="color:#ff0040;">‚ö†Ô∏è 12 Flagged</span> | <span style="color:#ff0040;">üö´ 3 Slashed</span>
    </div>
  </div>

  <div style="text-align:center; font-size:9px; margin-top:auto; padding:10px; opacity:0.5; flex-shrink:0;">
    Built by 0007bot | Colosseum 2026
  </div>
</div>

<script>
var currentTask = 1;
var currentStake = 0.1;
var currentRep = 0;

function setTask(val) {
  currentTask = val;
  // Update button styles
  [1, 3, 5, 10].forEach(t => {
    const btn = document.getElementById('btn-task-' + t);
    if (btn) {
      if (t === val) {
        btn.style.background = '#58C88D';
        btn.style.color = '#000';
        btn.style.fontWeight = 'bold';
      } else {
        btn.style.background = 'rgba(88,200,141,0.1)';
        btn.style.color = '#58C88D';
        btn.style.fontWeight = 'normal';
      }
    }
  });
  calc();
}

function setReputation(val) {
  currentRep = val;
  document.getElementById('rep').value = val;

  // Update button styles
  const levels = [
    { val: 0, id: 'new', label: 'New Agent' },
    { val: 250, id: 'established', label: 'Established' },
    { val: 500, id: 'trusted', label: 'Trusted' }
  ];

  levels.forEach(l => {
    const btn = document.getElementById('btn-rep-' + l.id);
    if (btn) {
      if (l.val === val) {
        btn.style.background = '#58C88D';
        btn.style.color = '#000';
        btn.style.fontWeight = 'bold';
      } else {
        btn.style.background = 'rgba(88,200,141,0.15)';
        btn.style.color = '#58C88D';
        btn.style.fontWeight = 'normal';
      }
    }
  });

  calc();
}

function setStake(val) {
  currentStake = Math.min(5, Math.max(0.1, val));
  updateStakeDisplay();

  // Update button styles
  const btnMapping = {
    '0.1': '01', '0.25': '025', '0.5': '05',
    '1': '1', '2.5': '25', '3': '3', '5': '5'
  };

  Object.keys(btnMapping).forEach(v => {
    const btnId = 'btn-stake-' + btnMapping[v];
    const btn = document.getElementById(btnId);
    if (btn) {
      if (Math.abs(parseFloat(v) - currentStake) < 0.01) {
        btn.style.background = '#58C88D';
        btn.style.color = '#000';
        btn.style.fontWeight = 'bold';
      } else {
        btn.style.background = v === '5' ? 'rgba(255,215,0,0.2)' : 'rgba(88,200,141,0.1)';
        btn.style.color = v === '5' ? '#ffd700' : '#58C88D';
        btn.style.fontWeight = 'normal';
      }
    }
  });
  calc();
}

function adjustStake(delta) {
  currentStake = Math.min(5, Math.max(0.1, currentStake + delta));
  updateStakeDisplay();
  // Update visual only, don't highlight a button since it's custom
  const btnMapping = {
    '0.1': '01', '0.25': '025', '0.5': '05',
    '1': '1', '2.5': '25', '3': '3', '5': '5'
  };
  Object.keys(btnMapping).forEach(v => {
    const btnId = 'btn-stake-' + btnMapping[v];
    const btn = document.getElementById(btnId);
    if (btn) {
      const isMatch = Math.abs(parseFloat(v) - currentStake) < 0.01;
      btn.style.background = isMatch ? '#58C88D' : (v === '5' ? 'rgba(255,215,0,0.2)' : 'rgba(88,200,141,0.1)');
      btn.style.color = isMatch ? '#000' : (v === '5' ? '#ffd700' : '#58C88D');
      btn.style.fontWeight = isMatch ? 'bold' : 'normal';
    }
  });
  calc();
}

function adjustStake(delta) {
  currentStake = Math.min(5, Math.max(0.1, currentStake + delta));
  updateStakeDisplay();
  updateStakeButtons();
  calc();
}

function updateStakeDisplay() {
  const display = document.getElementById('current-stake-display');
  if (display) display.textContent = currentStake.toFixed(1);
}

function updateStakeButtons() {
  const btnMapping = {
    '0.1': '01', '0.25': '025', '0.5': '05',
    '1': '1', '2.5': '25', '3': '3', '5': '5'
  };
  Object.keys(btnMapping).forEach(v => {
    const btnId = 'btn-stake-' + btnMapping[v];
    const btn = document.getElementById(btnId);
    if (btn) {
      const isMatch = Math.abs(parseFloat(v) - currentStake) < 0.01;
      btn.style.background = isMatch ? '#58C88D' : (v === '5' ? 'rgba(255,200,0,0.2)' : 'rgba(88,200,141,0.15)');
      btn.style.color = isMatch ? '#000' : (v === '5' ? '#ffd700' : '#58C88D');
      btn.style.fontWeight = isMatch ? 'bold' : 'normal';
    }
  });
}

// Calculator - MIN 0.1 SOL, MAX 5 SOL
function calc() {
  var rep = parseInt(document.getElementById('rep').value) || currentRep;
  currentRep = rep;

  // Calculate discount based on reputation
  var discount = rep >= 500 ? 50 : rep >= 250 ? 25 : 0;

  // Update displays
  document.getElementById('stake').textContent = currentStake.toFixed(1);

  // Update reputation label
  var repLabel = rep === 0 ? 'New Agent' : rep < 250 ? 'Building Rep' : rep < 500 ? 'Established' : 'Trusted';
  document.getElementById('repval').textContent = repLabel;
  document.getElementById('discount-display').textContent = discount + '%';

  // Update breakdown with new thesis
  var breakdown = '';
  if (currentStake <= 0.5) {
    breakdown = 'Entry level | Basic verification';
  } else if (currentStake <= 2) {
    breakdown = 'Moderate stake | Shows confidence';
  } else if (currentStake < 5) {
    breakdown = 'High stake | Strong trust signal';
  } else {
    breakdown = 'Maximum stake | Elite credibility';
  }
  if (discount > 0) {
    breakdown += ' | ' + discount + '% rep discount';
  }
  document.getElementById('breakdown').textContent = breakdown;
}

// Initialize
setTask(1);
setStake(0.1);
setReputation(0);

// Live Agents with realistic data
const liveAgents = [
  { name: "AlphaTrade_Bot", address: "7xK...9mP", rep: 850, staked: 45.5, vouchesIn: 156, vouchesOut: 23, accuracy: 94, lastActive: "2s ago", status: "safe" },
  { name: "DataFlow_Pro", address: "9mP...2nB", rep: 720, staked: 32.0, vouchesIn: 89, vouchesOut: 45, accuracy: 91, lastActive: "5s ago", status: "safe" },
  { name: "NewRecruit_07", address: "3kL...8kX", rep: 45, staked: 0.5, vouchesIn: 3, vouchesOut: 2, accuracy: 67, lastActive: "12s ago", status: "warning" },
  { name: "Suspicious_X", address: "5jH...6nQ", rep: -120, staked: 0, vouchesIn: 0, vouchesOut: 0, accuracy: 12, lastActive: "1h ago", status: "danger" }
];

// VERIFICATION ALGORITHM - Calculates status based on multiple factors
function calculateStatus(agent) {
  let score = 0;
  let reasons = [];

  // REPUTATION SCORE (0-400 points)
  if (agent.rep >= 500) {
    score += 400;
    reasons.push('High rep (500+)');
  } else if (agent.rep >= 200) {
    score += 300;
    reasons.push('Good rep (200+)');
  } else if (agent.rep >= 50) {
    score += 150;
    reasons.push('Building rep (50+)');
  } else if (agent.rep > 0) {
    score += 50;
    reasons.push('New agent (0-50)');
  } else {
    score -= 200;
    reasons.push('Negative rep');
  }

  // STAKE AMOUNT (0-300 points)
  if (agent.staked >= 10) {
    score += 300;
    reasons.push('High stake (10+ SOL)');
  } else if (agent.staked >= 5) {
    score += 250;
    reasons.push('Strong stake (5+ SOL)');
  } else if (agent.staked >= 2) {
    score += 150;
    reasons.push('Moderate stake (2+ SOL)');
  } else if (agent.staked >= 0.5) {
    score += 50;
    reasons.push('Low stake (0.5+ SOL)');
  } else {
    score -= 50;
    reasons.push('No/minimal stake');
  }

  // ACCURACY (0-200 points)
  if (agent.accuracy >= 90) {
    score += 200;
    reasons.push('Excellent accuracy (90%+)');
  } else if (agent.accuracy >= 75) {
    score += 150;
    reasons.push('Good accuracy (75%+)');
  } else if (agent.accuracy >= 50) {
    score += 50;
    reasons.push('Fair accuracy (50%+)');
  } else {
    score -= 100;
    reasons.push('Poor accuracy (<50%)');
  }

  // VOUCH ACTIVITY (0-100 points)
  const totalVouches = agent.vouchesIn + agent.vouchesOut;
  if (totalVouches >= 100) {
    score += 100;
    reasons.push('Very active (100+ vouches)');
  } else if (totalVouches >= 50) {
    score += 75;
    reasons.push('Active (50+ vouches)');
  } else if (totalVouches >= 10) {
    score += 40;
    reasons.push('Moderate activity (10+ vouches)');
  } else if (totalVouches >= 1) {
    score += 10;
    reasons.push('Minimal activity');
  } else {
    score -= 25;
    reasons.push('No activity');
  }

  // DETERMINE STATUS
  let status, color, text;
  if (score >= 700) {
    status = 'verified';
    color = '#58C88D';
    text = '‚úÖ VERIFIED';
  } else if (score >= 300) {
    status = 'monitoring';
    color = '#ffaa00';
    text = '‚ö†Ô∏è MONITORING';
  } else {
    status = 'suspicious';
    color = '#ff4444';
    text = 'üö´ SUSPICIOUS';
  }

  return { status, color, text, score, reasons };
}

function getStatusColor(rep, agent) {
  if (!agent) return rep > 500 ? '#58C88D' : rep > 0 ? '#ffaa00' : '#ff0040';
  const result = calculateStatus(agent);
  return result.color;
}

function getStatusText(status, agent) {
  if (agent) {
    const result = calculateStatus(agent);
    return result.text;
  }
  return status === 'safe' ? '‚úÖ VERIFIED' : status === 'warning' ? '‚ö†Ô∏è MONITORING' : 'üö´ SUSPICIOUS';
}

function renderAgents() {
  const list = document.getElementById('agent-list');
  list.innerHTML = liveAgents.map((a, i) => `
    <div class="agent-card ${calculateStatus(a).status === 'suspicious' ? 'suspicious' : ''}" id="agent-${i}" style="display:flex; justify-content:space-between; align-items:center; padding:6px 8px; margin:2px 0; background:rgba(88,200,141,0.1); border-left:3px solid ${calculateStatus(a).color}; border-radius:0 4px 4px 0; height:40px;">

      <!-- LEFT: Agent Identity -->
      <div style="flex:1; min-width:0;">
        <div style="display:flex; align-items:center; gap:6px; margin-bottom:2px;">
          <div style="width:10px; height:10px; background:${calculateStatus(a).color}; border-radius:50%; flex-shrink:0; box-shadow:0 0 6px ${calculateStatus(a).color};"></div>
          <strong style="font-size:13px; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${a.name}</strong>
          <span style="font-size:9px; color:#636363; font-family:'Courier New',monospace;">${a.address}</span>
        </div>
        <div style="font-size:10px; color:${calculateStatus(a).color}; font-weight:bold;">${calculateStatus(a).text} (${calculateStatus(a).score}pts)</div>
      </div>

      <!-- RIGHT: Stats Grid -->
      <div style="display:flex; gap:10px; text-align:center; margin-left:10px;">
        <div style="min-width:38px;">
          <div style="font-size:16px; font-weight:bold; color:${calculateStatus(a).color};" id="rep-${i}">${a.rep}</div>
          <div style="font-size:8px; color:#636363;">REP</div>
        </div>
        <div style="min-width:38px;">
          <div style="font-size:16px; font-weight:bold; color:#00ccff;" id="stake-${i}">${a.staked.toFixed(1)}</div>
          <div style="font-size:8px; color:#636363;">SOL</div>
        </div>
        <div style="min-width:34px;">
          <div style="font-size:16px; font-weight:bold; color:#58C88D;" id="vin-${i}">${a.vouchesIn}</div>
          <div style="font-size:8px; color:#636363;">IN</div>
        </div>
        <div style="min-width:34px;">
          <div style="font-size:16px; font-weight:bold; color:#ff4444;" id="vout-${i}">${a.vouchesOut}</div>
          <div style="font-size:8px; color:#636363;">OUT</div>
        </div>
      </div>

    </div>
  `).join('');
}
renderAgents();

// Live update simulation - MORE DRAMATIC
function updateAgents() {
  liveAgents.forEach((agent, i) => {
    // Update last active time
    const activeEl = document.getElementById(`active-${i}`);
    if (activeEl && Math.random() > 0.7) {
      const times = ['now', '1s ago', '2s ago', '5s ago', 'just now'];
      agent.lastActive = times[Math.floor(Math.random() * times.length)];
      activeEl.textContent = '‚óè ' + agent.lastActive;
      activeEl.style.color = agent.lastActive === 'now' ? '#58C88D' : '#636363';
    }

    // Reputation change
    if (Math.random() > 0.3) {
      const change = Math.floor(Math.random() * 40 - 10);
      const oldRep = agent.rep;
      agent.rep = Math.max(-200, Math.min(1000, agent.rep + change));

      const repEl = document.getElementById(`rep-${i}`);
      const changeEl = document.getElementById(`rep-change-${i}`);
      if (repEl && changeEl) {
        repEl.textContent = agent.rep;
        repEl.style.color = getStatusColor(agent.rep);
        repEl.style.textShadow = `0 0 15px ${getStatusColor(agent.rep)}`;

        const actualChange = agent.rep - oldRep;
        if (actualChange !== 0) {
          changeEl.textContent = actualChange > 0 ? `+${actualChange} ‚ñ≤` : `${actualChange} ‚ñº`;
          changeEl.style.color = actualChange > 0 ? '#58C88D' : '#ff0040';
        } else {
          changeEl.textContent = '';
        }
      }
    }

    // Stake change
    if (Math.random() > 0.5) {
      const stakeChange = (Math.random() * 3 - 0.5).toFixed(1);
      agent.staked = Math.max(0.1, agent.staked + parseFloat(stakeChange));
      const stakeEl = document.getElementById(`stake-${i}`);
      if (stakeEl) stakeEl.textContent = agent.staked.toFixed(1);
    }

    // Accuracy change
    if (Math.random() > 0.6) {
      const accChange = Math.floor(Math.random() * 6 - 2);
      agent.accuracy = Math.max(0, Math.min(100, agent.accuracy + accChange));
      const accEl = document.getElementById(`acc-${i}`);
      if (accEl) accEl.textContent = agent.accuracy;
    }

    // Vouch count change
    if (Math.random() > 0.5) {
      if (Math.random() > 0.4) agent.vouchesIn++;
      else agent.vouchesOut++;
      const vinEl = document.getElementById(`vin-${i}`);
      const voutEl = document.getElementById(`vout-${i}`);
      if (vinEl) vinEl.textContent = agent.vouchesIn;
      if (voutEl) voutEl.textContent = agent.vouchesOut;
    }
  });
}

setInterval(updateAgents, 600); // Update every 0.6 seconds

// Terminal Simulation
const term = document.getElementById('terminal-content');
const logs = [
  { c: 'log-reg', t: () => `[${time()}] ‚úÖ Agent_${rand()} registered | Rep: 50`, bg: false },
  { c: 'log-vouch', t: () => `[${time()}] üëç Vouch: ${rand()} ‚Üí ${rand()} | ${(Math.random()*2).toFixed(1)} SOL`, bg: false },
  { c: 'log-vouch', t: () => `[${time()}] üëé Negative vouch from ${rand()} | Risk: ${(Math.random()*0.5).toFixed(2)} SOL`, bg: false },
  { c: 'log-alert', t: () => `[${time()}] ‚ö†Ô∏è Pattern: Rapid vouching from 7xKX...`, bg: true, bgc: '#ffaa00', col: '#000' },
  { c: 'log-slash', t: () => `[${time()}] üö´ SLASHED: ${rand()} | Lost: ${(Math.random()*5+0.5).toFixed(2)} SOL`, bg: true, bgc: '#ff0040', col: '#fff' },
  { c: 'log-rep', t: () => `[${time()}] üìà REP CHANGE: ${rand()} | +${Math.floor(Math.random()*200)} points`, bg: true, bgc: '#58C88D', col: '#000' },
  { c: 'log-stake', t: () => `[${time()}] üí∞ MEGA STAKE: ${rand()} | ${(Math.random()*50+10).toFixed(1)} SOL`, bg: true, bgc: '#00ccff', col: '#000' }
];

function time() { return new Date().toLocaleTimeString('en-US', {hour12:false}); }
function rand() { return Math.random().toString(36).substring(7); }

function addLog() {
  const l = logs[Math.floor(Math.random() * logs.length)];
  const d = document.createElement('div');
  d.className = 'log-entry ' + l.c;
  d.textContent = l.t();
  if (l.bg) {
    d.style.background = l.bgc;
    d.style.color = l.col;
    d.style.padding = '3px 6px';
    d.style.fontWeight = 'bold';
    d.style.boxShadow = '0 0 10px ' + l.bgc;
  }
  term.appendChild(d);
  // Keep 10-15 transactions visible (max 15)
  while (term.children.length > 15) {
    term.removeChild(term.firstChild);
  }
  term.parentElement.scrollTop = term.parentElement.scrollHeight;
}

// Initialize with 12 logs
for (let i = 0; i < 12; i++) setTimeout(addLog, i * 150);
setInterval(addLog, 2000);
</script>

</body>
</html>
